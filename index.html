<!DOCTYPE html>
<html lang="en" class="dark">
<head>
<meta charset="UTF-8">
<title>SOLANA SNIPER EMPIRE — LIVE</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body { background: #000814; color: #00ff88; font-family: 'Courier New', monospace; }
  .glow { text-shadow: 0 0 30px #00ff88; }
  .profit { color: #00ff88; }
  .loss { color: #ff0066; }
  .card { background: rgba(20, 20, 40, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(0, 255, 136, 0.2); }
</style>
</head>
<body class="min-h-screen p-4 md:p-8">

<div class="max-w-7xl mx-auto">
  <h1 class="text-5xl md:text-7xl font-bold text-center glow mb-4">SOLANA SNIPER EMPIRE</h1>
  <p class="text-center text-xl mb-8">Wallet: <span id="wallet" class="font-mono">Connecting...</span></p>

  <!-- Stats -->
  <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-10">
    <div class="card rounded-2xl p-6 text-center"><div class="text-4xl profit font-bold" id="balance">$20.11</div><div>Balance</div></div>
    <div class="card rounded-2xl p-6 text-center"><div class="text-4xl font-bold" id="trades">0</div><div>Trades</div></div>
    <div class="card rounded-2xl p-6 text-center"><div class="text-4xl profit font-bold" id="profit">+0%</div><div>Profit</div></div>
    <div class="card rounded-2xl p-6 text-center"><div class="text-4xl font-bold" id="threshold">50</div><div>Threshold</div></div>
    <div class="card rounded-2xl p-6 text-center"><div class="text-4xl font-bold" id="size">$5</div><div>Trade Size</div></div>
  </div>

  <!-- Threshold + Withdraw -->
  <div class="grid md:grid-cols-2 gap-8 mb-10">
    <div class="card rounded-3xl p-8">
      <h2 class="text-3xl glow mb-6 text-center">THRESHOLD CONTROL</h2>
      <div class="flex items-center gap-6">
        <span>Aggressive</span>
        <input type="range" min="30" max="100" value="50" class="flex-1 h-3" id="slider">
        <span>Conservative</span>
        <span class="text-4xl font-bold w-20 text-center" id="value">50</span>
      </div>
      <button onclick="updateThreshold()" class="mt-6 w-full bg-gradient-to-r from-green-600 to-cyan-500 hover:from-green-500 hover:to-cyan-400 py-4 rounded-2xl text-2xl font-bold">UPDATE</button>
    </div>

    <div class="card rounded-3xl p-8">
      <h2 class="text-3xl glow mb-6 text-center">WITHDRAW PROFIT</h2>
      <div class="space-y-4">
        <input type="text" id="addr" placeholder="Enter any Solana address" class="w-full p-4 bg-black/50 border border-white/20 rounded-xl">
        <input type="number" id="percent" value="50" min="1" max="100" class="w-full p-4 bg-black/50 border border-white/20 rounded-xl text-center">
        <button onclick="withdraw()" class="w-full bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 py-4 rounded-2xl text-2xl font-bold">WITHDRAW NOW</button>
      </div>
    </div>
  </div>

  <!-- Log + Chart -->
  <div class="grid lg:grid-cols-2 gap-8">
    <div class="card rounded-3xl p-8">
      <h2 class="text-3xl glow mb-6">LIVE TRADE LOG</h2>
      <div id="log" class="space-y-3 max-h-96 overflow-y-auto text-lg"></div>
    </div>
    <div class="card rounded-3xl p-8">
      <h2 class="text-3xl glow mb-6">BALANCE GROWTH</h2>
      <canvas id="chart"></canvas>
    </div>
  </div>
</div>

<script>
let balance = 20.11;
let history = [{time: new Date().toLocaleTimeString(), balance}];
let chart;

// Slider
const slider = document.getElementById('slider');
const value.textContent = slider.value;
slider.oninput = () => value.textContent = slider.value;

async function updateThreshold() {
  await fetch('/api/update-threshold', {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({threshold:+slider.value})});
  alert("Threshold updated to " + slider.value);
}

async function withdraw() {
  const addr = document.getElementById('addr').value.trim();
  const pct = document.getElementById('percent').value;
  if (!addr) return alert("Enter address");
  const res = await fetch('/api/withdraw', {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({address:addr,percent:+pct})});
  const d = await res.json();
  if (d.success) alert(`Withdrawn $${d.withdrawn} → ${addr.slice(0,6)}...${addr.slice(-4)}`);
}

// Live update
async function load() {
  try {
    const r = await fetch('/api/status');
    const d = await r.json();
    document.getElementById('balance').textContent = '$' + d.balance;
    document.getElementById('threshold').textContent = d.threshold || 50;
    document.getElementById('wallet').textContent = d.wallet || 'Unknown';
    // Add new trades to log, update chart, etc.
  } catch(e) {}
}
setInterval(load, 5000);
load();

new Chart(document.getElementById('chart'), {
  type: 'line',
  data: { labels: history.map(h=>h.time), datasets: [{ data: history.map(h=>h.balance), borderColor: '#00ff88', tension: 0.4, fill: true }] },
  options: { responsive: true, scales: { y: { beginAtZero: false } } }
});
</script>
</body>
</html>
